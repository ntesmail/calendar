/*! calendar - v0.0.1 - 2014-04-12
* https://github.com/ntesmail/calendar
* Copyright (c) 2014 ; Licensed  */
!function(){var a={};!function(){function b(a){var b,c=a.getFullYear(),d=a.getMonth(),e=new Date(c,d,1);b=1===d?c%4===0?29:28:6>d?d%2===1?30:31:d%2===0?30:31;var g=new Date(c,d,b);return f(g),{start:e,end:g}}function c(a){var b=a.getDay(),c=new Date(a);e(c),c.setDate(a.getDate()-b);var d=new Date(a);return e(d),d.setDate(a.getDate()+(6-b)),f(d),{start:c,end:d}}function d(a){var b=new Date(a);e(b);var c=new Date(a);return f(c),{start:b,end:c}}function e(a){return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a}function f(a){return a.setHours(23),a.setMinutes(59),a.setSeconds(59),a}function g(a){var b=new Date(a);return e(b),Math.floor(b.getTime()/864e5)}function h(a,b){if("undefined"!=typeof a&&a.length>0&&"undefined"!=typeof b){for(var c=[],d=0;d<a.length;d++){var e=!0;for(var f in b)e&&(b[f](a[d])||(e=!1));e&&c.push(a[d])}return c}return a}function i(a){a.addClass("f-hide")}function j(a){a.removeClass("f-hide")}a.util={},a.util.getMonthRange=b,a.util.getWeekRange=c,a.util.getDayRange=d,a.util.clearTime=e,a.util.getDayNumber=g,a.util.filterEvents=h,a.util.hide=i,a.util.show=j}(),function(){function b(a){function b(){return g}function c(){return h}function d(){return j}function e(){return i}function f(){return color}var g,h,i,j;g=a.title,h=a.start;var k=this;k.getTitle=b,k.getStart=c,k.getEnd=d,k.getType=e,k.getColor=f}a.Event=b}(),function(){function b(b){function c(b,c,h){for(var i=a.util.getDayNumber(b),j=a.util.getDayNumber(c),k=!1,l=i;j>=l;l++){var m=g[l];if("undefined"==typeof m){k=!0;var n=$.Deferred();return n.done(function(a,b,c){e(i,j,c),h.resolve(d(i,j,g))}),n.fail(function(){h.resolve(d(i,j,g))}),void f(b,c,n)}}h.resolve(d(i,j,g))}function d(a,b,c){for(var d=[],e=a;b>=e;e++)d[e]=c[e];return d}function e(b,c,d){for(var e=b;c>=e;e++)g[e]=[];for(var e=0;e<d.length;e++){var f=a.util.getDayNumber(d[e].start);"undefined"!=typeof g[f]?g[f].push(new a.Event(d[e])):g[f]=[]}}var f=b.fetchEvents,g=[];this.fetch=c}a.EventManager=b}(),function(){function b(b,d,e,f){function g(){return u}function h(){a.util.hide(u)}function i(){a.util.show(u)}function j(){f.onDestroy&&f.onDestroy(D);for(var a=0;a<C.length;a++)C[a].destroy();C.length=0,u.remove(),u=null}function k(){return t}function l(){var b=a.util.getMonthRange(t).start;return b.setMonth(b.getMonth()+1),b}function m(){var b=a.util.getMonthRange(t).start;return b.setMonth(b.getMonth()-1),b}function n(){var a=["周日","周一","周二","周三","周四","周五","周六"];v=$("<div></div>");for(var b=0;7>b;b++){var c=$("<div>"+a[b]+"</div>");c.css({width:z,height:B,position:"absolute",top:0,border:"solid 1px green",left:z*b}),v.append(c)}u.append(v)}function o(b){t=b;var d=a.util.getMonthRange(b);q=a.util.getWeekRange(d.start).start,r=a.util.getWeekRange(d.end).end,s=b.getMonth();var e=a.util.clearTime(r);w=(e-q)/6048e5,z=Math.floor(x/7),A=Math.floor(y/w),n();for(var g=0;w>g;g++)for(var h=0;7>h;h++){var i=new Date(q);i.setDate(i.getDate()+7*g+h);var j={width:z,height:A,posTop:B+A*g,posLeft:z*h,date:i},k=new c(j);i.getMonth()!==s,u.append(k.getContainer()),C.push(k)}var l=$.Deferred();l.done(function(b){for(var c=0;c<C.length;c++){var d=C[c],e=d.getDate(),g=a.util.getDayNumber(e);f.renderEvents(d,b[g],!0)}}),f.getEventManager().fetch(q,r,l)}function p(a,b){x=a,y=b,z=Math.floor(x/7),A=Math.floor(y/w);for(var c=v.children(),d=0;d<c.length;d++)$(c[d]).css({left:z*d,width:z});for(var d=0;w>d;d++)for(var e=0;7>e;e++){var f=7*d+e;C[f].resize(z,A,B+A*d,z*e)}}var q,r,s,t,u,v,w,x,y,z,A,B,C=[],f=f;x=b.width,y=b.height,B=e.headerHeight,u=$("<div></div>");var D=this;D.getContainer=g,D.render=o,D.hide=h,D.show=i,D.destroy=j,D.getCurrent=k,D.getNext=l,D.getPrev=m,D.resize=p}function c(a){function b(){return g}function c(){return l}function d(){f(a.width,a.height,a.posTop,a.posLeft),g.append(l.getDate())}function e(){g=null}function f(a,b,c,d){h=a,i=b,j=c,k=d,g.css({position:"absolute",width:h,height:i,top:j,left:k})}var g,h,i,j,k,l;g=$('<div style="overflow:hidden;border:1px solid black;"></div>'),h=a.width,i=a.height,j=a.posTop,k=a.posLeft,l=a.date;var m=this;m.getContainer=b,m.render=d,m.getDate=c,m.resize=f,m.destroy=e,m.render()}a.MonthView=b}(),function(){function b(b,d,e,f){function g(){return v}function h(){a.util.hide(v)}function i(){f.onDestroy&&f.onDestroy(G);for(var a=0;a<F.length;a++)F[a].destroy();F.length=0,v.remove(),v=null}function j(){a.util.show(v)}function k(){return u}function l(){var b=a.util.getWeekRange(u).start;return b.setDate(b.getDate()+7),b}function m(){var b=a.util.getWeekRange(u).start;return b.setDate(b.getDate()-7),b}function n(){var a=["周日","周一","周二","周三","周四","周五","周六"];D=$("<div></div>");for(var b=0;7>b;b++){var c=$("<div>"+a[b]+"</div>");c.css({width:y,height:A,position:"absolute",top:0,border:"solid 1px green",left:B+y*b}),D.append(c)}v.append(D)}function o(){var a=["凌晨","上午","下午","晚上"];E=$("<div></div>");for(var b=0;4>b;b++){var c=$("<div>"+a[b]+"</div>");c.css({width:B,height:z,position:"absolute",top:A+z*b,border:"solid 1px green",left:0}),E.append(c)}v.append(E)}function p(b){u=b;var d=a.util.getWeekRange(b);r=d.start,s=d.end,t=b.getMonth(),C=4,y=Math.floor(w/7),z=Math.floor(x/C),n(),o();for(var e=0;C>e;e++)for(var g=0;7>g;g++){var h=new Date(r);h.setDate(h.getDate()+g),h.setHours(e*(24/C));var i={width:y,height:z,posTop:A+z*e,posLeft:B+y*g,date:h},j=new c(i);h.getMonth()!==t,v.append(j.getContainer()),F.push(j)}var k=$.Deferred();k.done(function(b){for(var c=0;c<F.length;c++){var d=F[c],e=d.getDate(),g=a.util.getDayNumber(e),h=b[g],i=[];if(h.length>0){var j=d.getDate(),k=new Date(j);k.setHours(k.getHours()+6);for(var l=0;l<h.length;l++){var m=h[l];m.getStart()<k&&m.getStart()>=j&&i.push(m)}}f.renderEvents(d,i,!0)}}),f.getEventManager().fetch(r,s,k)}function q(a,b){w=a,x=b,y=Math.floor(w/7),z=Math.floor(x/C);for(var c=D.children(),d=0;d<c.length;d++)$(c[d]).css({left:B+y*d,width:y});for(var c=E.children(),d=0;d<c.length;d++)$(c[d]).css({top:A+z*d,height:z});for(var d=0;C>d;d++)for(var e=0;7>e;e++){var f=7*d+e;F[f].resize(y,z,A+z*d,B+y*e)}}var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=[],f=f;w=b.width,x=b.height,A=e.headerHeight,B=e.leftHeaderWidth,v=$("<div></div>");var G=this;G.getContainer=g,G.render=p,G.hide=h,G.show=j,G.destroy=i,G.getCurrent=k,G.getNext=l,G.getPrev=m,G.resize=q}function c(a){function b(){return h}function c(){return m}function d(){f(a.width,a.height,a.posTop,a.posLeft),h.append(m.getDate())}function e(){h=null}function f(a,b,c,d){i=a,j=b,k=c,l=d,h.css({position:"absolute",width:i,height:j,top:k,left:l}),g()}function g(){}var h,i,j,k,l,m;h=$('<div style="overflow:hidden;border:1px solid black;"></div>'),i=a.width,j=a.height,k=a.posTop,l=a.posLeft,m=a.date;var n=this;n.getContainer=b,n.render=d,n.getDate=c,n.resize=f,n.destroy=e,n.render()}a.WeekView=b}(),function(){function b(b,d,e,f){function g(){return s}function h(){a.util.hide(s)}function i(){a.util.show(s)}function j(){f.onDestroy&&f.onDestroy(z);for(var a=0;a<y.length;a++)y[a].destroy();y.length=0,s.remove(),s=null}function k(){return r}function l(){var a=new Date(r);return a.setDate(a.getDate()+1),a}function m(){var a=new Date(r);return a.setDate(a.getDate()-1),a}function n(d){r=d;var e=a.util.getDayRange(d);p=e.start,q=e.end;v=b.width;var g=$.Deferred();g.done(function(b){var d=a.util.getDayNumber(r),e=b[d];if("undefined"!=typeof e&&e.length>0){e.sort(function(a,b){return a.getStart()-b.getStart()});for(var g={},h=0;h<e.length;h++){var i=e[h];g[i.getStart()]?g[i.getStart()].push(i):g[i.getStart()]=[i]}for(var j in g){var k=a.util.filterEvents(g[j],f.getFilters());if(k.length>0){var l={width:v,date:k[0].getStart()},m=new c(l);y.push(m),f.renderEvents(m,k,!1),s.append(m.getContainer())}}}}),f.getEventManager().fetch(p,q,g)}function o(a,b){t=a,u=b;for(var c=0;c<y.length;c++)y[c].resize(t)}var p,q,r,s,t,u,v,w,x,y=[],f=f;t=b.width,u=b.height,w=e.headerHeight,x=e.leftHeaderWidth,s=new $("<div></div>");var z=this;z.getContainer=g,z.render=n,z.hide=h,z.show=i,z.destroy=j,z.getCurrent=k,z.getNext=l,z.getPrev=m,z.resize=o}function c(a){function b(){return g}function c(){return i}function d(){f(a.width),g.append(i.getHours()+":"+i.getMinutes())}function e(){g.remove(),g=null}function f(a){h=a,g.css({width:h})}var g,h,i;g=new $('<div style="overflow:hidden;border:1px solid black;"></div>'),h=a.width,i=a.date;var j=this;j.getContainer=b,j.render=d,j.getDate=c,j.resize=f,j.destroy=e,j.render()}a.DayView=b}(),function(){function b(b,d){function e(){r=new a.EventManager({fetchEvents:d.fetchEvents}),n(u)}function f(){return r}function g(){return t}function h(){var a=q.getNext();n(p,a)}function i(){var a=q.getPrev();n(p,a)}function j(a){p!==a&&n(a)}function k(a){v=a,n(p)}function l(){return v}function m(b,c,d){if(d){var e=a.util.filterEvents(c,v);w(b,e)}else w(b,c)}function n(c,e){switch(e||(e=new Date),q&&(q.destroy(),q=null),c){case"month":q=new a.MonthView(b,d,y,B);break;case"week":q=new a.WeekView(b,d,z,B);break;case"day":q=new a.DayView(b,d,A,B)}p=c,q.render(e),t.append(q.getContainer()),q.show()}function o(a,c){b.width=a,b.height=c,q&&(s&&clearTimeout(s),s=setTimeout(function(){console.log("resize"),q.resize(a,c)},200))}var p,q,r,s,t=$(c),u=b.defaultView||"month",v=b.filters,w=d.onRenderEvents,x=d.onDestroy,y={headerHeight:20},z={headerHeight:20,leftHeaderWidth:40},A={headerHeight:20,leftHeaderWidth:40};"string"==typeof b.clsName&&t.addClass(b.clsName);var B=this;B.render=e,B.getContainer=g,B.getEventManager=f,B.prev=i,B.next=h,B.changeView=j,B.changeFilters=k,B.getFilters=l,B.resize=o,B.renderEvents=m,B.onDestroy=x,B.render()}a.Calendar=b;var c="<div></div>"}(),"undefined"==typeof shark?window.FullCalendar=a.Calendar:shark.FullCalendar=a.Calendar}();