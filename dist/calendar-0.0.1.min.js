/*! calendar - v0.0.1 - 2014-04-19
* https://github.com/ntesmail/calendar
* Copyright (c) 2014 ; Licensed  */
!function(){var a={};!function(){function b(a){var b,c=a.getFullYear(),d=a.getMonth(),e=new Date(c,d,1);b=1===d?c%4===0?29:28:6>d?d%2===1?30:31:d%2===0?30:31;var g=new Date(c,d,b);return f(g),{start:e,end:g}}function c(a){var b=a.getDay(),c=new Date(a);e(c),c.setDate(a.getDate()-b);var d=new Date(a);return e(d),d.setDate(a.getDate()+(6-b)),f(d),{start:c,end:d}}function d(a){var b=new Date(a);e(b);var c=new Date(a);return f(c),{start:b,end:c}}function e(a){return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a}function f(a){return a.setHours(23),a.setMinutes(59),a.setSeconds(59),a}function g(a){var b=new Date(a);return e(b),Math.floor(b.getTime()/864e5)}function h(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()}function i(a,b){if("undefined"!=typeof a&&a.length>0&&"undefined"!=typeof b){for(var c=[],d=0;d<a.length;d++){var e=!0;for(var f in b)e&&(b[f](a[d])||(e=!1));e&&c.push(a[d])}return c}return a}function j(a){a.addClass("f-hide")}function k(a){a.removeClass("f-hide")}a.util={},a.util.getMonthRange=b,a.util.getWeekRange=c,a.util.getDayRange=d,a.util.clearTime=e,a.util.getDayNumber=g,a.util.isSameDay=h,a.util.filterEvents=i,a.util.hide=j,a.util.show=k}(),function(){function b(a){function b(){return i}function c(){return j}function d(){return o}function e(){return k}function f(){return n}function g(){return m}function h(){return l}var i,j,k,l,m,n,o;i=a.id,j=a.title,k=a.start,m=a.type,n=a.end,o=a.repeate,l=a.color;var p=this;p.getId=b,p.getTitle=c,p.getStart=e,p.getEnd=f,p.getType=g,p.getColor=h,p.getRepeate=d}a.Event=b}(),function(){function b(b){function c(b,c,h){for(var i=a.util.getDayNumber(b),j=a.util.getDayNumber(c),k=!1,l=i;j>=l;l++){var m=g[l];if("undefined"==typeof m){k=!0;var n=$.Deferred();return n.done(function(a,b,c){e(i,j,c),h.resolve(d(i,j,g))}),n.fail(function(){h.resolve(d(i,j,g))}),void f(b,c,n)}}h.resolve(d(i,j,g))}function d(a,b,c){for(var d=[],e=a;b>=e;e++)d[e]=c[e];return d}function e(b,c,d){for(var e=b;c>=e;e++)g[e]=[];for(var e=0;e<d.length;e++){var f=a.util.getDayNumber(d[e].start);"undefined"!=typeof g[f]?g[f].push(new a.Event(d[e])):g[f]=[]}}var f=b.fetchEvents,g=[];this.fetch=c}a.EventManager=b}(),function(){function b(b,c){function d(){return m}function e(){return r}function f(){return c.getViewName()}function g(){return n}function h(){return o}function i(){return c.getCurrentMonth()===r.getMonth()}function j(){l(b.width,b.height,b.posTop,b.posLeft),a.util.isSameDay(r,new Date)&&m.addClass("can-crt")}function k(){m=null}function l(a,b,c,d){n=a,o=b,p=c,q=d,m.css({width:n,height:o,top:p,left:q})}var m,n,o,p,q,r;m=$('<div class="can can-block"></div>'),n=b.width,o=b.height,p=b.posTop,q=b.posLeft,r=b.date;var s=this;s.getContainer=d,s.render=j,s.getDate=e,s.isCurrentMonth=i,s.resize=l,s.destroy=k,s.getViewName=f,s.getWidth=g,s.getHeight=h,s.render()}a.TimeBlock=b}(),function(){function b(b,d,e,f){function g(){return B}function h(){return C}function i(){return c}function j(){return y}function k(){a.util.hide(y)}function l(){a.util.show(y)}function m(){f.onDestroy&&f.onDestroy(H);for(var a=0;a<G.length;a++)G[a].destroy();G.length=0,y.remove(),y=null}function n(){return x}function o(){return w}function p(){var b=a.util.getMonthRange(x).start;return b.setMonth(b.getMonth()+1),b}function q(){var b=a.util.getMonthRange(x).start;return b.setMonth(b.getMonth()-1),b}function r(a){z=[];for(var b=0;7>b;b++){var d=$('<div class="can can-week"></div>');d.css({width:D,height:F,top:0,left:D*b}),z.push(d);var e=new Date(a);e.setDate(e.getDate()+b),f.renderHeader(c,d,e),y.append(d)}}function s(b){x=b;var c=a.util.getMonthRange(b);u=a.util.getWeekRange(c.start).start,v=a.util.getWeekRange(c.end).end,w=b.getMonth();var d=a.util.clearTime(v);A=Math.ceil((d-u)/6048e5),r(u);for(var e=0;A>e;e++)for(var g=0;7>g;g++){var h=new Date(u);h.setDate(h.getDate()+7*e+g);var i={date:h},j=new a.TimeBlock(i,H);h.getMonth()!==w,y.append(j.getContainer()),G.push(j)}t(B,C);var k=$.Deferred();k.done(function(b){for(var c=0;c<G.length;c++){var d=G[c],e=d.getDate(),g=a.util.getDayNumber(e);f.renderEvents(d,b[g],!0)}}),f.getEventManager().fetch(u,v,k)}function t(a,b){B=a,C=b,D=Math.floor(B/7),E=Math.floor(C/A),B=7*D,C=E*A,y.css({width:B,height:C+F});for(var c=0;c<z.length;c++)z[c].css({left:D*c,width:D});for(var c=0;A>c;c++)for(var d=0;7>d;d++){var e=7*c+d;G[e].resize(D,E,F+E*c,D*d)}}var u,v,w,x,y,z,A,B,C,D,E,F,G=[],f=f;B=b.width,C=b.height,F=e.headerHeight,y=$('<div class="m-calendar m-calendar-'+c+'"></div>'),"string"==typeof e.clsName&&y.addClass(e.clsName);var H=this;H.getContainer=j,H.render=s,H.hide=k,H.show=l,H.destroy=m,H.getCurrent=n,H.getCurrentMonth=o,H.getNext=p,H.getPrev=q,H.resize=t,H.getViewName=i,H.getWidth=g,H.getHeight=h}a.MonthView=b;var c="month"}(),function(){function b(b,d,e,f){function g(){return A}function h(){return B}function i(){return c}function j(){return z}function k(){a.util.hide(z)}function l(){f.onDestroy&&f.onDestroy(K);for(var a=0;a<J.length;a++)J[a].destroy();J.length=0,z.remove(),z=null}function m(){a.util.show(z)}function n(){return y}function o(){return x}function p(){var b=a.util.getWeekRange(y).start;return b.setDate(b.getDate()+7),b}function q(){var b=a.util.getWeekRange(y).start;return b.setDate(b.getDate()-7),b}function r(a){H=[];for(var b=0;7>b;b++){var d=$('<div class="can can-week"></div>');d.css({width:C,height:E,top:0,left:F+C*b}),H.push(d);var e=new Date(a);e.setDate(e.getDate()+b),f.renderHeader(c,d,e),z.append(H)}}function s(){I=[];var a=$('<div class="can can-blank"></div>');a.css({top:0,left:0,width:F,height:E}),z.append(a);for(var b=0;4>b;b++){var d=$('<div class="can can-time"></div>');d.css({width:F,height:D,top:E+D*b,left:0}),I.push(d),f.renderVerticalHeader(c,d,b),z.append(d)}}function t(b){y=b;var c=a.util.getWeekRange(b);v=c.start,w=c.end,x=b.getMonth(),G=4,r(v,w),s();for(var d=0;G>d;d++)for(var e=0;7>e;e++){var g=new Date(v);g.setDate(g.getDate()+e),g.setHours(d*(24/G));var h={date:g},i=new a.TimeBlock(h,K);g.getMonth()!==x,z.append(i.getContainer()),J.push(i)}u(A,B);var j=$.Deferred();j.done(function(b){for(var c=0;c<J.length;c++){var d=J[c],e=d.getDate(),g=a.util.getDayNumber(e),h=b[g],i=[];if(h.length>0){var j=d.getDate(),k=new Date(j);k.setHours(k.getHours()+6);for(var l=0;l<h.length;l++){var m=h[l];m.getStart()<k&&m.getStart()>=j&&i.push(m)}}f.renderEvents(d,i,!0)}}),f.getEventManager().fetch(v,w,j)}function u(a,b){A=a,B=b,C=Math.floor((A-F)/7),D=Math.floor((B-E)/G),A=7*C,B=D*G,z.css({width:A+F,height:B+E});for(var c=0;c<H.length;c++)H[c].css({left:F+C*c,width:C});for(var c=0;c<I.length;c++)I[c].css({top:E+D*c,height:D});for(var c=0;G>c;c++)for(var d=0;7>d;d++){var e=7*c+d;J[e].resize(C,D,E+D*c,F+C*d)}}var v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=[],f=f;A=b.width,B=b.height,E=e.headerHeight,F=e.leftHeaderWidth,z=$('<div class="m-calendar m-calendar-'+c+'"></div>'),"string"==typeof e.clsName&&z.addClass(e.clsName);var K=this;K.getContainer=j,K.render=t,K.hide=k,K.show=m,K.destroy=l,K.getCurrent=n,K.getCurrentMonth=o,K.getNext=p,K.getPrev=q,K.resize=u,K.getViewName=i,K.getWidth=g,K.getHeight=h}a.WeekView=b;var c="week"}(),function(){function b(b,d,e,f){function g(){return w}function h(){return v.height()}function i(){return c}function j(){return v}function k(){a.util.hide(v)}function l(){a.util.show(v)}function m(){f.onDestroy&&f.onDestroy(B);for(var a=0;a<A.length;a++)A[a].destroy();A.length=0,v.remove(),v=null}function n(){return u}function o(){var a=new Date(u);return a.setDate(a.getDate()+1),a}function p(){var a=new Date(u);return a.setDate(a.getDate()-1),a}function q(b){u=b;var c=a.util.getDayRange(b);s=c.start,t=c.end;var d=$.Deferred();d.done(function(b){var c=a.util.getDayNumber(u),d=b[c];if("undefined"!=typeof d&&d.length>0){d.sort(function(a,b){return a.getStart()-b.getStart()});for(var e={},g=0;g<d.length;g++){var h=d[g];e[h.getStart()]?e[h.getStart()].push(h):e[h.getStart()]=[h]}for(var i in e){var j=a.util.filterEvents(e[i],f.getFilters());if(j.length>0){var k={date:j[0].getStart()},l=new a.TimeBlock(k,B);A.push(l),f.renderEvents(l,j,!1);var m=k.date.getMinutes(),n=k.date.getHours()+":"+(m>=10?m:"0"+m),o=$('<div class="can can-time"><span class="w-time">'+n+"</span></div>");v.append(o),v.append(l.getContainer())}}r(w,x)}}),f.getEventManager().fetch(s,t,d)}function r(a,b){w=a,x=b,v.css({width:w});for(var c=0;c<A.length;c++)A[c].resize(w-z-1)}var s,t,u,v,w,x,y,z,A=[],f=f;w=b.width,x=b.height,y=e.headerHeight,z=e.leftHeaderWidth,v=$('<div class="m-calendar m-calendar-'+c+'"></div>'),"string"==typeof e.clsName&&v.addClass(e.clsName);var B=this;B.getContainer=j,B.render=q,B.hide=k,B.show=l,B.destroy=m,B.getCurrent=n,B.getNext=o,B.getPrev=p,B.resize=r,B.getViewName=i,B.getWidth=g,B.getHeight=h}a.DayView=b;var c="day"}(),function(){function b(b,c){function d(){return v.getWidth()}function e(){return v.getHeight()}function f(){w=new a.EventManager({fetchEvents:c.fetchEvents}),r(z,u)}function g(){return w}function h(){return y}function i(){var a=v.getNext();return r(t,a),a}function j(){var a=v.getPrev();return r(t,a),a}function k(a,b){r(a,b)}function l(a){t!==a&&r(a)}function m(a){A=a,r(t)}function n(){return A}function o(b,c,d){if(d){var e=a.util.filterEvents(c,A);B(b,e)}else B(b,c)}function p(a,b,c){C(a,b,c)}function q(a,b,c){E(a,b,c)}function r(d,e){e||(e=u||new Date);var f="undefined"!=typeof v;switch(v&&(v.destroy(),v=null),d){case"month":v=new a.MonthView(b,c,H,K);break;case"week":v=new a.WeekView(b,c,I,K);break;case"day":v=new a.DayView(b,c,J,K)}t=d,v.render(e),y.append(v.getContainer()),v.show(),f&&"function"==typeof D&&D(v)}function s(a,c){b.width=a,b.height=c,v&&(x&&clearTimeout(x),x=setTimeout(function(){v.resize(a,c),"function"==typeof G&&G(a,c)},200))}var t,u,v,w,x,y=$('<div class="js-calendar-container"></div>'),z=b.defaultView||"month",A=b.filters,B=c.onRenderEvents,C=c.onRenderHeader,D=c.onViewChanged,E=c.onRenderVerticalHeader,F=c.onDestroy,G=c.onSizeChanged,H={headerHeight:20},I={headerHeight:20,leftHeaderWidth:100},J={headerHeight:20,leftHeaderWidth:100};"object"==typeof b.monthOpt&&(H=$.extend(H,b.monthOpt)),"object"==typeof b.weekOpt&&(I=$.extend(I,b.weekOpt)),"object"==typeof b.dayOpt&&(J=$.extend(J,b.dayOpt)),"string"==typeof b.clsName&&y.addClass(b.clsName),"undefined"!=typeof b.date&&(u=new Date(b.date));var K=this;K.render=f,K.getContainer=h,K.getEventManager=g,K.prev=j,K.next=i,K.goDate=k,K.changeView=l,K.changeFilters=m,K.getFilters=n,K.resize=s,K.renderEvents=o,K.renderHeader=p,K.renderVerticalHeader=q,K.onDestroy=F,K.getWidth=d,K.getHeight=e,K.render()}a.Calendar=b}(),"undefined"==typeof shark?window.FullCalendar=a.Calendar:shark.FullCalendar=a.Calendar}();