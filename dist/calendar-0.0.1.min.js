/*! calendar - v0.0.1 - 2014-04-19
* https://github.com/ntesmail/calendar
* Copyright (c) 2014 ; Licensed  */
!function(){var a={};!function(){function b(a){var b,c=a.getFullYear(),d=a.getMonth(),e=new Date(c,d,1);b=1===d?c%4===0?29:28:6>d?d%2===1?30:31:d%2===0?30:31;var g=new Date(c,d,b);return f(g),{start:e,end:g}}function c(a){var b=a.getDay(),c=new Date(a);e(c),c.setDate(a.getDate()-b);var d=new Date(a);return e(d),d.setDate(a.getDate()+(6-b)),f(d),{start:c,end:d}}function d(a){var b=new Date(a);e(b);var c=new Date(a);return f(c),{start:b,end:c}}function e(a){return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a}function f(a){return a.setHours(23),a.setMinutes(59),a.setSeconds(59),a}function g(a){var b=new Date(a);return e(b),Math.floor(b.getTime()/864e5)}function h(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()}function i(a,b){if("undefined"!=typeof a&&a.length>0&&"undefined"!=typeof b){for(var c=[],d=0;d<a.length;d++){var e=!0;for(var f in b)e&&(b[f](a[d])||(e=!1));e&&c.push(a[d])}return c}return a}function j(a){a.addClass("f-hide")}function k(a){a.removeClass("f-hide")}a.util={},a.util.getMonthRange=b,a.util.getWeekRange=c,a.util.getDayRange=d,a.util.clearTime=e,a.util.getDayNumber=g,a.util.isSameDay=h,a.util.filterEvents=i,a.util.hide=j,a.util.show=k}(),function(){function b(a){function b(){return i}function c(){return j}function d(){return o}function e(){return k}function f(){return n}function g(){return m}function h(){return l}var i,j,k,l,m,n,o;i=a.id,j=a.title,k=a.start,m=a.type,n=a.end,o=a.repeate,l=a.color;var p=this;p.getId=b,p.getTitle=c,p.getStart=e,p.getEnd=f,p.getType=g,p.getColor=h,p.getRepeate=d}a.Event=b}(),function(){function b(b){function c(b,c,h){for(var i=a.util.getDayNumber(b),j=a.util.getDayNumber(c),k=!1,l=i;j>=l;l++){var m=g[l];if("undefined"==typeof m){k=!0;var n=$.Deferred();return n.done(function(a,b,c){e(i,j,c),h.resolve(d(i,j,g))}),n.fail(function(){h.resolve(d(i,j,g))}),void f(b,c,n)}}h.resolve(d(i,j,g))}function d(a,b,c){for(var d=[],e=a;b>=e;e++)d[e]=c[e];return d}function e(b,c,d){for(var e=b;c>=e;e++)g[e]=[];for(var e=0;e<d.length;e++){var f=a.util.getDayNumber(d[e].start);"undefined"!=typeof g[f]?g[f].push(new a.Event(d[e])):g[f]=[]}}var f=b.fetchEvents,g=[];this.fetch=c}a.EventManager=b}(),function(){function b(b,c){function d(){return m}function e(){return r}function f(){return c.getViewName()}function g(){return n}function h(){return o}function i(){return c.getCurrentMonth()===r.getMonth()}function j(){l(b.width,b.height,b.posTop,b.posLeft),a.util.isSameDay(r,new Date)&&m.addClass("can-crt")}function k(){m=null}function l(a,b,c,d){n=a,o=b,p=c,q=d,m.css({width:n,height:o,top:p,left:q})}var m,n,o,p,q,r;m=$('<div class="can can-block"></div>'),n=b.width,o=b.height,p=b.posTop,q=b.posLeft,r=b.date;var s=this;s.getContainer=d,s.render=j,s.getDate=e,s.isCurrentMonth=i,s.resize=l,s.destroy=k,s.getViewName=f,s.getWidth=g,s.getHeight=h,s.render()}a.TimeBlock=b}(),function(){function b(b,d,e,f){function g(){return c}function h(){return w}function i(){a.util.hide(w)}function j(){a.util.show(w)}function k(){f.onDestroy&&f.onDestroy(F);for(var a=0;a<E.length;a++)E[a].destroy();E.length=0,w.remove(),w=null}function l(){return v}function m(){return u}function n(){var b=a.util.getMonthRange(v).start;return b.setMonth(b.getMonth()+1),b}function o(){var b=a.util.getMonthRange(v).start;return b.setMonth(b.getMonth()-1),b}function p(a){x=[];for(var b=0;7>b;b++){var d=$('<div class="can can-week"></div>');d.css({width:B,height:D,top:0,left:B*b}),x.push(d);var e=new Date(a);e.setDate(e.getDate()+b),f.renderHeader(c,d,e),w.append(d)}}function q(b){v=b;var c=a.util.getMonthRange(b);s=a.util.getWeekRange(c.start).start,t=a.util.getWeekRange(c.end).end,u=b.getMonth();var d=a.util.clearTime(t);y=Math.ceil((d-s)/6048e5),p(s);for(var e=0;y>e;e++)for(var g=0;7>g;g++){var h=new Date(s);h.setDate(h.getDate()+7*e+g);var i={date:h},j=new a.TimeBlock(i,F);h.getMonth()!==u,w.append(j.getContainer()),E.push(j)}r(z,A);var k=$.Deferred();k.done(function(b){for(var c=0;c<E.length;c++){var d=E[c],e=d.getDate(),g=a.util.getDayNumber(e);f.renderEvents(d,b[g],!0)}}),f.getEventManager().fetch(s,t,k)}function r(a,b){z=a,A=b,B=Math.floor(z/7),C=Math.floor(A/y),z=7*B,A=C*y,w.css({width:z,height:A+D});for(var c=0;c<x.length;c++)x[c].css({left:B*c,width:B});for(var c=0;y>c;c++)for(var d=0;7>d;d++){var e=7*c+d;E[e].resize(B,C,D+C*c,B*d)}}var s,t,u,v,w,x,y,z,A,B,C,D,E=[],f=f;z=b.width,A=b.height,D=e.headerHeight,w=$('<div class="m-calendar m-calendar-'+c+'"></div>'),"string"==typeof e.clsName&&w.addClass(e.clsName);var F=this;F.getContainer=h,F.render=q,F.hide=i,F.show=j,F.destroy=k,F.getCurrent=l,F.getCurrentMonth=m,F.getNext=n,F.getPrev=o,F.resize=r,F.getViewName=g}a.MonthView=b;var c="month"}(),function(){function b(b,d,e,f){function g(){return c}function h(){return x}function i(){a.util.hide(x)}function j(){f.onDestroy&&f.onDestroy(I);for(var a=0;a<H.length;a++)H[a].destroy();H.length=0,x.remove(),x=null}function k(){a.util.show(x)}function l(){return w}function m(){return v}function n(){var b=a.util.getWeekRange(w).start;return b.setDate(b.getDate()+7),b}function o(){var b=a.util.getWeekRange(w).start;return b.setDate(b.getDate()-7),b}function p(a){F=[];for(var b=0;7>b;b++){var d=$('<div class="can can-week"></div>');d.css({width:A,height:C,top:0,left:D+A*b}),F.push(d);var e=new Date(a);e.setDate(e.getDate()+b),f.renderHeader(c,d,e),x.append(F)}}function q(){G=[];var a=$('<div class="can can-blank"></div>');a.css({top:0,left:0,width:D,height:C}),x.append(a);for(var b=0;4>b;b++){var d=$('<div class="can can-time"></div>');d.css({width:D,height:B,top:C+B*b,left:0}),G.push(d),f.renderVerticalHeader(c,d,b),x.append(d)}}function r(b){w=b;var c=a.util.getWeekRange(b);t=c.start,u=c.end,v=b.getMonth(),E=4,p(t,u),q();for(var d=0;E>d;d++)for(var e=0;7>e;e++){var g=new Date(t);g.setDate(g.getDate()+e),g.setHours(d*(24/E));var h={date:g},i=new a.TimeBlock(h,I);g.getMonth()!==v,x.append(i.getContainer()),H.push(i)}s(y,z);var j=$.Deferred();j.done(function(b){for(var c=0;c<H.length;c++){var d=H[c],e=d.getDate(),g=a.util.getDayNumber(e),h=b[g],i=[];if(h.length>0){var j=d.getDate(),k=new Date(j);k.setHours(k.getHours()+6);for(var l=0;l<h.length;l++){var m=h[l];m.getStart()<k&&m.getStart()>=j&&i.push(m)}}f.renderEvents(d,i,!0)}}),f.getEventManager().fetch(t,u,j)}function s(a,b){y=a,z=b,A=Math.floor((y-D)/7),B=Math.floor((z-C)/E),y=7*A,z=B*E,x.css({width:y+D,height:z+C});for(var c=0;c<F.length;c++)F[c].css({left:D+A*c,width:A});for(var c=0;c<G.length;c++)G[c].css({top:C+B*c,height:B});for(var c=0;E>c;c++)for(var d=0;7>d;d++){var e=7*c+d;H[e].resize(A,B,C+B*c,D+A*d)}}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=[],f=f;y=b.width,z=b.height,C=e.headerHeight,D=e.leftHeaderWidth,x=$('<div class="m-calendar m-calendar-'+c+'"></div>'),"string"==typeof e.clsName&&x.addClass(e.clsName);var I=this;I.getContainer=h,I.render=r,I.hide=i,I.show=k,I.destroy=j,I.getCurrent=l,I.getCurrentMonth=m,I.getNext=n,I.getPrev=o,I.resize=s,I.getViewName=g}a.WeekView=b;var c="week"}(),function(){function b(b,d,e,f){function g(){return c}function h(){return t}function i(){a.util.hide(t)}function j(){a.util.show(t)}function k(){f.onDestroy&&f.onDestroy(z);for(var a=0;a<y.length;a++)y[a].destroy();y.length=0,t.remove(),t=null}function l(){return s}function m(){var a=new Date(s);return a.setDate(a.getDate()+1),a}function n(){var a=new Date(s);return a.setDate(a.getDate()-1),a}function o(b){s=b;var c=a.util.getDayRange(b);q=c.start,r=c.end;var d=$.Deferred();d.done(function(b){var c=a.util.getDayNumber(s),d=b[c];if("undefined"!=typeof d&&d.length>0){d.sort(function(a,b){return a.getStart()-b.getStart()});for(var e={},g=0;g<d.length;g++){var h=d[g];e[h.getStart()]?e[h.getStart()].push(h):e[h.getStart()]=[h]}for(var i in e){var j=a.util.filterEvents(e[i],f.getFilters());if(j.length>0){var k={date:j[0].getStart()},l=new a.TimeBlock(k,z);y.push(l),f.renderEvents(l,j,!1);var m=k.date.getMinutes(),n=k.date.getHours()+":"+(m>=10?m:"0"+m),o=$('<div class="can can-time"><span class="w-time">'+n+"</span></div>");t.append(o),t.append(l.getContainer())}}p(u,v)}}),f.getEventManager().fetch(q,r,d)}function p(a,b){u=a,v=b,t.css({width:u});for(var c=0;c<y.length;c++)y[c].resize(u-x-1)}var q,r,s,t,u,v,w,x,y=[],f=f;u=b.width,v=b.height,w=e.headerHeight,x=e.leftHeaderWidth,t=$('<div class="m-calendar m-calendar-'+c+'"></div>'),"string"==typeof e.clsName&&t.addClass(e.clsName);var z=this;z.getContainer=h,z.render=o,z.hide=i,z.show=j,z.destroy=k,z.getCurrent=l,z.getNext=m,z.getPrev=n,z.resize=p,z.getViewName=g}a.DayView=b;var c="day"}(),function(){function b(b,c){function d(){u=new a.EventManager({fetchEvents:c.fetchEvents}),p(x,s)}function e(){return u}function f(){return w}function g(){var a=t.getNext();return p(r,a),a}function h(){var a=t.getPrev();return p(r,a),a}function i(a,b){p(a,b)}function j(a){r!==a&&p(a)}function k(a){y=a,p(r)}function l(){return y}function m(b,c,d){if(d){var e=a.util.filterEvents(c,y);z(b,e)}else z(b,c)}function n(a,b,c){A(a,b,c)}function o(a,b,c){C(a,b,c)}function p(d,e){e||(e=s||new Date);var f="undefined"!=typeof t;switch(t&&(t.destroy(),t=null),d){case"month":t=new a.MonthView(b,c,E,H);break;case"week":t=new a.WeekView(b,c,F,H);break;case"day":t=new a.DayView(b,c,G,H)}r=d,t.render(e),w.append(t.getContainer()),t.show(),f&&"function"==typeof B&&B(t)}function q(a,c){b.width=a,b.height=c,t&&(v&&clearTimeout(v),v=setTimeout(function(){t.resize(a,c)},200))}var r,s,t,u,v,w=$('<div class="js-calendar-container"></div>'),x=b.defaultView||"month",y=b.filters,z=c.onRenderEvents,A=c.onRenderHeader,B=c.onViewChanged,C=c.onRenderVerticalHeader,D=c.onDestroy,E={headerHeight:20},F={headerHeight:20,leftHeaderWidth:100},G={headerHeight:20,leftHeaderWidth:100};"object"==typeof b.monthOpt&&(E=$.extend(E,b.monthOpt)),"object"==typeof b.weekOpt&&(F=$.extend(F,b.weekOpt)),"object"==typeof b.dayOpt&&(G=$.extend(G,b.dayOpt)),"string"==typeof b.clsName&&w.addClass(b.clsName),"undefined"!=typeof b.date&&(s=new Date(b.date));var H=this;H.render=d,H.getContainer=f,H.getEventManager=e,H.prev=h,H.next=g,H.goDate=i,H.changeView=j,H.changeFilters=k,H.getFilters=l,H.resize=q,H.renderEvents=m,H.renderHeader=n,H.renderVerticalHeader=o,H.onDestroy=D,H.render()}a.Calendar=b}(),"undefined"==typeof shark?window.FullCalendar=a.Calendar:shark.FullCalendar=a.Calendar}();