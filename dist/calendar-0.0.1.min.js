/*! calendar - v0.0.1 - 2014-04-15
* https://github.com/ntesmail/calendar
* Copyright (c) 2014 ; Licensed  */
!function(){var a={};!function(){function b(a){var b,c=a.getFullYear(),d=a.getMonth(),e=new Date(c,d,1);b=1===d?c%4===0?29:28:6>d?d%2===1?30:31:d%2===0?30:31;var g=new Date(c,d,b);return f(g),{start:e,end:g}}function c(a){var b=a.getDay(),c=new Date(a);e(c),c.setDate(a.getDate()-b);var d=new Date(a);return e(d),d.setDate(a.getDate()+(6-b)),f(d),{start:c,end:d}}function d(a){var b=new Date(a);e(b);var c=new Date(a);return f(c),{start:b,end:c}}function e(a){return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a}function f(a){return a.setHours(23),a.setMinutes(59),a.setSeconds(59),a}function g(a){var b=new Date(a);return e(b),Math.floor(b.getTime()/864e5)}function h(a,b){if("undefined"!=typeof a&&a.length>0&&"undefined"!=typeof b){for(var c=[],d=0;d<a.length;d++){var e=!0;for(var f in b)e&&(b[f](a[d])||(e=!1));e&&c.push(a[d])}return c}return a}function i(a){a.addClass("f-hide")}function j(a){a.removeClass("f-hide")}a.util={},a.util.getMonthRange=b,a.util.getWeekRange=c,a.util.getDayRange=d,a.util.clearTime=e,a.util.getDayNumber=g,a.util.filterEvents=h,a.util.hide=i,a.util.show=j}(),function(){function b(a){function b(){return g}function c(){return h}function d(){return j}function e(){return i}function f(){return color}var g,h,i,j;g=a.title,h=a.start;var k=this;k.getTitle=b,k.getStart=c,k.getEnd=d,k.getType=e,k.getColor=f}a.Event=b}(),function(){function b(b){function c(b,c,h){for(var i=a.util.getDayNumber(b),j=a.util.getDayNumber(c),k=!1,l=i;j>=l;l++){var m=g[l];if("undefined"==typeof m){k=!0;var n=$.Deferred();return n.done(function(a,b,c){e(i,j,c),h.resolve(d(i,j,g))}),n.fail(function(){h.resolve(d(i,j,g))}),void f(b,c,n)}}h.resolve(d(i,j,g))}function d(a,b,c){for(var d=[],e=a;b>=e;e++)d[e]=c[e];return d}function e(b,c,d){for(var e=b;c>=e;e++)g[e]=[];for(var e=0;e<d.length;e++){var f=a.util.getDayNumber(d[e].start);"undefined"!=typeof g[f]?g[f].push(new a.Event(d[e])):g[f]=[]}}var f=b.fetchEvents,g=[];this.fetch=c}a.EventManager=b}(),function(){function b(b,e,f,g){function h(){return w}function i(){a.util.hide(w)}function j(){a.util.show(w)}function k(){g.onDestroy&&g.onDestroy(F);for(var a=0;a<E.length;a++)E[a].destroy();E.length=0,w.remove(),w=null}function l(){return v}function m(){return u}function n(){var b=a.util.getMonthRange(v).start;return b.setMonth(b.getMonth()+1),b}function o(){var b=a.util.getMonthRange(v).start;return b.setMonth(b.getMonth()-1),b}function p(a){x=[];for(var b=0;7>b;b++){var c=$('<div class="can can-week"></div>');c.css({width:B,height:D,top:0,left:B*b}),x.push(c);var e=new Date(a);e.setDate(e.getDate()+b),g.renderHeader(d,c,e),w.append(c)}}function q(b){v=b;var d=a.util.getMonthRange(b);s=a.util.getWeekRange(d.start).start,t=a.util.getWeekRange(d.end).end,u=b.getMonth();var e=a.util.clearTime(t);y=Math.ceil((e-s)/6048e5),p(s);for(var f=0;y>f;f++)for(var h=0;7>h;h++){var i=new Date(s);i.setDate(i.getDate()+7*f+h);var j={date:i},k=new c(j,F);i.getMonth()!==u,w.append(k.getContainer()),E.push(k)}r(z,A);var l=$.Deferred();l.done(function(b){for(var c=0;c<E.length;c++){var d=E[c],e=d.getDate(),f=a.util.getDayNumber(e);g.renderEvents(d,b[f],!0)}}),g.getEventManager().fetch(s,t,l)}function r(a,b){z=a,A=b,B=Math.floor(z/7),C=Math.floor(A/y),z=7*B,A=C*y,w.css({width:z,height:A+D});for(var c=0;c<x.length;c++)x[c].css({left:B*c,width:B});for(var c=0;y>c;c++)for(var d=0;7>d;d++){var e=7*c+d;E[e].resize(B,C,D+C*c,B*d)}}var s,t,u,v,w,x,y,z,A,B,C,D,E=[],g=g;z=b.width,A=b.height,D=f.headerHeight,w=$('<div class="m-calendar m-calendar-'+d+'"></div>');var F=this;F.getContainer=h,F.render=q,F.hide=i,F.show=j,F.destroy=k,F.getCurrent=l,F.getCurrentMonth=m,F.getNext=n,F.getPrev=o,F.resize=r}function c(a,b){function c(){return k}function e(){return p}function f(){return d}function g(){return b.getCurrentMonth()===p.getMonth()}function h(){j(a.width,a.height,a.posTop,a.posLeft)}function i(){k=null}function j(a,b,c,d){l=a,m=b,n=c,o=d,k.css({width:l,height:m,top:n,left:o})}var k,l,m,n,o,p;k=$('<div class="can can-block"></div>'),l=a.width,m=a.height,n=a.posTop,o=a.posLeft,p=a.date;var q=this;q.getContainer=c,q.render=h,q.getDate=e,q.isCurrentMonth=g,q.resize=j,q.destroy=i,q.getViewName=f,q.render()}a.MonthView=b;var d="month"}(),function(){function b(b,e,f,g){function h(){return x}function i(){a.util.hide(x)}function j(){g.onDestroy&&g.onDestroy(I);for(var a=0;a<H.length;a++)H[a].destroy();H.length=0,x.remove(),x=null}function k(){a.util.show(x)}function l(){return w}function m(){return v}function n(){var b=a.util.getWeekRange(w).start;return b.setDate(b.getDate()+7),b}function o(){var b=a.util.getWeekRange(w).start;return b.setDate(b.getDate()-7),b}function p(a){F=[];for(var b=0;7>b;b++){var c=$('<div class="can can-week"></div>');c.css({width:A,height:C,top:0,left:D+A*b}),F.push(c);var e=new Date(a);e.setDate(e.getDate()+b),g.renderHeader(d,c,e),x.append(F)}}function q(){G=[];var a=$('<div class="can can-blank"></div>');a.css({top:0,left:0,width:D,height:C}),x.append(a);for(var b=0;4>b;b++){var c=$('<div class="can can-time"></div>');c.css({width:D,height:B,top:C+B*b,left:0}),G.push(c),g.renderVerticalHeader(d,c,b),x.append(c)}}function r(b){w=b;var d=a.util.getWeekRange(b);t=d.start,u=d.end,v=b.getMonth(),E=4,p(t,u),q();for(var e=0;E>e;e++)for(var f=0;7>f;f++){var h=new Date(t);h.setDate(h.getDate()+f),h.setHours(e*(24/E));var i={date:h},j=new c(i);h.getMonth()!==v,x.append(j.getContainer()),H.push(j)}s(y,z);var k=$.Deferred();k.done(function(b){for(var c=0;c<H.length;c++){var d=H[c],e=d.getDate(),f=a.util.getDayNumber(e),h=b[f],i=[];if(h.length>0){var j=d.getDate(),k=new Date(j);k.setHours(k.getHours()+6);for(var l=0;l<h.length;l++){var m=h[l];m.getStart()<k&&m.getStart()>=j&&i.push(m)}}g.renderEvents(d,i,!0)}}),g.getEventManager().fetch(t,u,k)}function s(a,b){y=a,z=b,A=Math.floor(y/7),B=Math.floor(z/E),y=7*A,z=B*E,x.css({width:y+D,height:z+C});for(var c=0;c<F.length;c++)F[c].css({left:D+A*c,width:A});for(var c=0;c<G.length;c++)G[c].css({top:C+B*c,height:B});for(var c=0;E>c;c++)for(var d=0;7>d;d++){var e=7*c+d;H[e].resize(A,B,C+B*c,D+A*d)}}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=[],g=g;y=b.width,z=b.height,C=f.headerHeight,D=f.leftHeaderWidth,x=$('<div class="m-calendar m-calendar-'+d+'"></div>');var I=this;I.getContainer=h,I.render=r,I.hide=i,I.show=k,I.destroy=j,I.getCurrent=l,I.getCurrentMonth=m,I.getNext=n,I.getPrev=o,I.resize=s}function c(a,b){function c(){return l}function e(){return d}function f(){return q}function g(){j(a.width,a.height,a.posTop,a.posLeft)}function h(){return b.getCurrentMonth()===q.getMonth()}function i(){l=null}function j(a,b,c,d){m=a,n=b,o=c,p=d,l.css({width:m,height:n,top:o,left:p}),k()}function k(){}var l,m,n,o,p,q;l=$('<div class="can can-block"></div>'),m=a.width,n=a.height,o=a.posTop,p=a.posLeft,q=a.date;var r=this;r.getContainer=c,r.render=g,r.getDate=f,r.isCurrentMonth=h,r.resize=j,r.destroy=i,r.getViewName=e,r.render()}a.WeekView=b;var d="week"}(),function(){function b(b,e,f,g){function h(){return t}function i(){a.util.hide(t)}function j(){a.util.show(t)}function k(){g.onDestroy&&g.onDestroy(z);for(var a=0;a<y.length;a++)y[a].destroy();y.length=0,t.remove(),t=null}function l(){return s}function m(){var a=new Date(s);return a.setDate(a.getDate()+1),a}function n(){var a=new Date(s);return a.setDate(a.getDate()-1),a}function o(b){s=b;var d=a.util.getDayRange(b);q=d.start,r=d.end;var e=$.Deferred();e.done(function(b){var d=a.util.getDayNumber(s),e=b[d];if("undefined"!=typeof e&&e.length>0){e.sort(function(a,b){return a.getStart()-b.getStart()});for(var f={},h=0;h<e.length;h++){var i=e[h];f[i.getStart()]?f[i.getStart()].push(i):f[i.getStart()]=[i]}for(var j in f){var k=a.util.filterEvents(f[j],g.getFilters());if(k.length>0){var l={date:k[0].getStart()},m=new c(l);y.push(m),g.renderEvents(m,k,!1);var n=$('<div class="can can-time"><span class="w-time">'+s.getHours()+":"+s.getMinutes()+"</span></div>");t.append(n),t.append(m.getContainer())}}p(u,v)}}),g.getEventManager().fetch(q,r,e)}function p(a,b){u=a,v=b,t.css({width:u});for(var c=0;c<y.length;c++)y[c].resize(u-x-1)}var q,r,s,t,u,v,w,x,y=[],g=g;u=b.width,v=b.height,w=f.headerHeight,x=f.leftHeaderWidth,t=$('<div class="m-calendar m-calendar-'+d+'"></div>');var z=this;z.getContainer=h,z.render=o,z.hide=i,z.show=j,z.destroy=k,z.getCurrent=l,z.getNext=m,z.getPrev=n,z.resize=p}function c(a){function b(){return i}function c(){return k}function e(){return d}function f(){h(a.width)}function g(){i.remove(),i=null}function h(a){j=a,i.css({width:j})}var i,j,k;i=new $('<div class="can can-block"></div>'),j=a.width,k=a.date;var l=this;l.getContainer=b,l.render=f,l.getDate=c,l.resize=h,l.destroy=g,l.getViewName=e,l.render()}a.DayView=b;var d="day"}(),function(){function b(b,c){function d(){s=new a.EventManager({fetchEvents:c.fetchEvents}),o(v)}function e(){return s}function f(){return u}function g(){var a=r.getNext();o(q,a)}function h(){var a=r.getPrev();o(q,a)}function i(a){q!==a&&o(a)}function j(a){w=a,o(q)}function k(){return w}function l(b,c,d){if(d){var e=a.util.filterEvents(c,w);x(b,e)}else x(b,c)}function m(a,b,c){y(a,b,c)}function n(a,b,c){z(a,b,c)}function o(d,e){switch(e||(e=new Date),r&&(r.destroy(),r=null),d){case"month":r=new a.MonthView(b,c,B,E);break;case"week":r=new a.WeekView(b,c,C,E);break;case"day":r=new a.DayView(b,c,D,E)}q=d,r.render(e),u.append(r.getContainer()),r.show()}function p(a,c){b.width=a,b.height=c,r&&(t&&clearTimeout(t),t=setTimeout(function(){r.resize(a,c)},200))}var q,r,s,t,u=$('<div class="js-calendar-container"></div>'),v=b.defaultView||"month",w=b.filters,x=c.onRenderEvents,y=c.onRenderHeader,z=c.onRenderVerticalHeader,A=c.onDestroy,B={headerHeight:20},C={headerHeight:20,leftHeaderWidth:100},D={headerHeight:20,leftHeaderWidth:100};"object"==typeof b.monthOpt&&(B=$.extend(B,b.monthOpt)),"object"==typeof b.weekOpt&&(C=$.extend(C,b.weekOpt)),"object"==typeof b.dayOpt&&(D=$.extend(D,b.dayOpt)),"string"==typeof b.clsName&&u.addClass(b.clsName);var E=this;E.render=d,E.getContainer=f,E.getEventManager=e,E.prev=h,E.next=g,E.changeView=i,E.changeFilters=j,E.getFilters=k,E.resize=p,E.renderEvents=l,E.renderHeader=m,E.renderVerticalHeader=n,E.onDestroy=A,E.render()}a.Calendar=b}(),"undefined"==typeof shark?window.FullCalendar=a.Calendar:shark.FullCalendar=a.Calendar}();